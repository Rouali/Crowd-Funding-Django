{% extends 'base.html' %}

{% block content %}
<div class="project-detail-container" style="background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%); min-height: 100vh; padding: 2rem 0;">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-lg-10">
        <div class="card border-0 shadow-lg" style="border-radius: 16px; overflow: hidden;">
          <div class="card-header py-4 text-white" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
            <h2 class="mb-0 fw-bold text-center" style="letter-spacing: 0.5px;">{{ project.title }}</h2>
            {% if project.is_cancelled %}
            <div class="badge bg-danger mt-2">Cancelled</div>
            {% endif %}
          </div>
          
          <div class="card-body p-4 p-md-5" style="background-color: #ffffff;">
            <!-- Funding Progress Section -->
            <div class="funding-progress mb-5">
              <h4 class="fw-medium mb-3">Funding Progress</h4>
              <div class="progress mb-3" style="height: 25px; border-radius: 12px;">
                <div class="progress-bar" 
                     role="progressbar" 
                     style="width: {{ project.funding_percentage|floatformat:0|default:0 }}%; background-color: #667eea; border-radius: 12px;"
                     aria-valuenow="{{ project.funding_percentage|floatformat:0|default:0 }}" 
                     aria-valuemin="0" 
                     aria-valuemax="100">
                  {{ project.funding_percentage|floatformat:1|default:0 }}%
                </div>
              </div>
              <p class="text-muted mb-4">
                Raised: EGP {{ project.total_donations|floatformat:2|default:0 }} of EGP {{ project.total_target|floatformat:2 }}
              </p>
              
              {% if messages %}
              <div class="alert alert-dismissible fade show" role="alert">
                {% for message in messages %}
                <div{% if message.tags %} class="alert alert-{{ message.tags }}"{% endif %}>
                  {{ message }}
                </div>
                {% endfor %}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
              </div>
              {% endif %}
            </div>

            <div class="mb-5">
              <p class="text-gray-600">{{ project.details }}</p>
            </div>

            <div class="d-flex justify-content-between align-items-center">
              <a href="{% url 'projects:project_list' %}" 
                 class="btn py-2 px-4 fw-medium"
                 style="background: #e2e8f0; color: #4a5568; border-radius: 8px;">
                <i class="bi bi-arrow-left me-2"></i>Back to Projects
              </a>
              
              <div class="btn-group">
                {% if project.user == request.user and not project.is_cancelled %}
                <a href="{% url 'projects:project_update' project.id %}" 
                   class="btn py-2 px-4 me-2"
                   style="background: #667eea; color: white; border-radius: 8px;">
                  Edit Project
                </a>
                <a href="{% url 'projects:project_delete' project.id %}" 
                   class="btn py-2 px-4 me-2"
                   style="background: #e53e3e; color: white; border-radius: 8px;">
                  Delete
                </a>
                <form action="{% url 'projects:project_cancel' project.id %}" method="POST" class="d-inline">
                  {% csrf_token %}
                  <button type="submit" 
                          class="btn py-2 px-4"
                          style="background: #f6ad55; color: white; border-radius: 8px;"
                          {% if project.funding_percentage|floatformat:0|default:0 >= 25 %}disabled{% endif %}>
                    Cancel Project
                  </button>
                </form>
                {% endif %}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
.progress-bar {
  transition: width 0.5s ease-in-out;
}
.progress {
  background-color: #e2e8f0;
}
.text-muted {
  color: #718096 !important;
}
.badge {
  font-size: 0.85rem;
  padding: 0.5rem 1rem;
}
</style>
{% endblock %}